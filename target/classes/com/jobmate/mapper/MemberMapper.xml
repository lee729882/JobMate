<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.jobmate.mapper.MemberMapper">

  <!-- 아이디 중복 여부 -->
  <select id="existsByUsername" parameterType="string" resultType="int">
    SELECT CASE WHEN COUNT(1) > 0 THEN 1 ELSE 0 END
    FROM MEMBER
    WHERE USERNAME = #{username}
  </select>

  <!-- 이메일 중복 여부 -->
  <select id="existsByEmail" parameterType="string" resultType="int">
    SELECT CASE WHEN COUNT(1) > 0 THEN 1 ELSE 0 END
    FROM MEMBER
    WHERE EMAIL = #{email}
  </select>
  
<insert id="insertMember" parameterType="com.jobmate.domain.Member">
  INSERT INTO MEMBER (
    ID,
    USERNAME, PASSWORD, EMAIL, NAME,
    CAREER_TYPE, EDU_CODE, MIN_SALARY,
    JOB_CODES, WORK_REGION_CODES
  )
  VALUES (
    MEMBER_SEQ.NEXTVAL,
    #{username},
    #{password},
    #{email},
    <!-- NAME 이 NVARCHAR2면 NVARCHAR, VARCHAR2면 VARCHAR 로 바꿔주세요 -->
    #{name, jdbcType=NVARCHAR},
    #{careerType, jdbcType=VARCHAR},
    #{eduCode,    jdbcType=VARCHAR},
    <!-- NUMBER 컬럼이면 NUMERIC/DECIMAL/INTEGER 중 하나 (NUMBER(p,0)면 INTEGER도 가능) -->
    #{minSalary,  jdbcType=NUMERIC},
    #{jobCodes,        jdbcType=VARCHAR},
    #{workRegionCodes, jdbcType=VARCHAR}
  )
</insert>


  <!-- SELECT: mapUnderscoreToCamelCase=true면 resultType으로 충분 -->
  <select id="findByUsername" parameterType="string" resultType="com.jobmate.domain.Member">
    SELECT
      ID, USERNAME, PASSWORD, EMAIL, NAME,
      CAREER_TYPE, EDU_CODE, MIN_SALARY,
      JOB_CODES, WORK_REGION_CODES
      -- , CREATED_AT   <!-- 필요 시 주석 해제하고 Member에 필드 추가 -->
    FROM MEMBER
    WHERE USERNAME = #{username}
  </select>

</mapper>
