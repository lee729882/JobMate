<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.jobmate.mapper.RecentViewedMapper">

  <!-- ✅ 중복 제거 -->
  <delete id="deleteDuplicate" parameterType="map">
    DELETE FROM recent_viewed
    WHERE member_id = #{memberId}
      AND emp_seqno = #{empSeqno}
  </delete>

  <!-- ✅ 최근 본 공고 추가 -->
  <insert id="addRecentViewed" parameterType="map">
    INSERT INTO recent_viewed
      (member_id, emp_source, emp_seqno, emp_title, emp_company, emp_deadline, viewed_at)
    VALUES
      (#{memberId}, #{empSource}, #{empSeqno}, #{empTitle}, #{empCompany}, #{empDeadline}, SYSDATE)
  </insert>

<select id="getRecentViewedList" parameterType="long" resultType="map">
  SELECT *
  FROM recent_viewed
  WHERE member_id = #{memberId}
  ORDER BY viewed_at DESC
  FETCH FIRST 10 ROWS ONLY
</select>



</mapper>